

<body>
    <%- include('partials/header') %>
    <section id="slider">
      <div class="swiper slider">
        <div class="swiper-wrapper">
          <div class="swiper-slide d-flex jarallax position-relative"
            style="background-image: url(images/banner-img1.jpg); background-size: cover; background-repeat: no-repeat; height: 90vh; background-position: center; height: 90vh;">
            <div class="banner-content text-center m-auto" data-aos="zoom-out">
              <h2 class="banner-title display-2 fw-normal text-white mb-4">Experience the Art of Grooming and Style</h2>
              <a  href="#appointment"  class="btn btn-primary mt-3">Book an Appointment</a>
            </div>
          </div>
          <div class="swiper-slide d-flex jarallax position-relative"
            style="background-image: url(images/banner-img3.jpg); background-size: cover; background-repeat: no-repeat; height: 90vh; background-position: center; height: 90vh;">
            <div class="banner-content text-center m-auto" data-aos="zoom-out">
              <h2 class="banner-title display-2 fw-normal text-white mb-4">Refine Your Look with Expert Barbers</h2>
              <a href="appointment.html" class="btn btn-primary mt-3">Book an Appointment</a>
            </div>
          </div>
          <div class="swiper-slide d-flex jarallax position-relative"
            style="background-image: url(images/banner-img2.jpg); background-size: cover; background-repeat: no-repeat; height: 90vh; background-position: center; height: 90vh;">
            <div class="banner-content text-center m-auto" data-aos="zoom-out">
              <h2 class="banner-title display-2 fw-normal text-white mb-4">Classic Cuts & Modern Styles for Every
                Gentleman</h2>
              <a href="appointment.html" class="btn btn-primary mt-3">Book an Appointment</a>
            </div>
          </div>
        </div>
        <div class="position-absolute top-0 bottom-0 end-0 m-auto me-0 me-md-5 main-slider-button-next">
          <svg class="arrow-right light-color" width="60" height="60">
            <use xlink:href="#arrow-right"></use>
          </svg>
        </div>
        <div class="position-absolute top-0 bottom-0 start-0 m-auto ms-0 ms-md-5 main-slider-button-prev">
          <svg class="arrow-left light-color" width="60" height="60">
            <use xlink:href="#arrow-left"></use>
          </svg>
        </div>
      </div>
    </section>

    <section id="booking" class="jarallax" 
    style="background-image: url(images/background-22.jpg); background-repeat: no-repeat; background-position: center;">

    <div class="container-lg padding-medium">

      <div class="offset-md-3 col-md-6 text-center ">

        <h2 class="display-4 fw-normal text-white mb-3">Membership Registration</h2>
        <p class="text-white">  Become a member and enjoy exclusive perks — from priority bookings to special discounts on your favorite beauty treatments. Let us pamper you in style.</p>

        <div class="d-flex justify-content-center">
          <a href="/register" class="btn btn-light mt-3 px-4">Become a member</a>
        </div>

      </div>

    </div>
    </div>
  </section>
    <section id="categories">
      <div class="container-lg padding-medium">
        <div class="row">
          <div class="col-md-3 my-3">
            <div class="text-center">
              <iconify-icon class="service-icon text-primary display-3"
                icon="solar:medal-ribbons-star-outline"></iconify-icon>
              <h3 class="py-2 ">10+ Years of Experience</h3>
              <p class="blog-paragraph">Over a decade of delivering top-tier grooming services with consistency, care, and style.</p>
            </div>
          </div>
          <div class="col-md-3 my-3">
            <div class="text-center">
              <iconify-icon class="service-icon text-primary display-3" icon="ph:plant"></iconify-icon>
              <h3 class="py-2 ">100% natural Products</h3>
              <p class="blog-paragraph">We use only premium, chemical-free products that are safe for your hair, skin, and the environment.</p>
            </div>
          </div>
          <div class="col-md-3 my-3">
            <div class="text-center">
              <iconify-icon class="service-icon text-primary display-3"
                icon="solar:chat-round-like-broken"></iconify-icon>
              <h3 class="py-2 ">12k+ Satisfied Clients</h3>
              <p class="blog-paragraph">Thousands of happy clients trust us for their fresh cuts, flawless fades, and personalized service.</p>
            </div>
          </div>
          <div class="col-md-3 my-3">
            <div class="text-center">
              <iconify-icon class="service-icon text-primary display-3" icon="solar:people-nearby-outline"></iconify-icon>
              <h3 class="py-2 ">28 Specialistis Team</h3>
              <p class="blog-paragraph">Our expert team of barbers and stylists are trained, talented, and passionate about what they do.</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  
    <section id="services" class="jarallax"
      style="background-image: url(images/background-22.jpg); background-size: cover; background-repeat: no-repeat; background-position: center;">
      <div class="container-lg padding-medium">
        <div class="section-title text-center mb-5">
          <h2 class="display-4 fw-normal text-white">Services We Offer</h2>
        </div>
  
        <div class="row g-lg-5 my-0">
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img5.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover;">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Classic Haircuts</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img3.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Beard Trimming & Styling</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img7.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Hot Towel Shave</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img8.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Hair Coloring & Highlights</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img2.jpg" class="img-fluid" alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Scalp Treatment & Massage</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img1.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Men's Grooming Packages</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img4.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Luxury Beard Treatment</h4>
              </a>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 my-4">
            <div class="text-center ">
              <a href="services-single.html">
                <div class="zoom-effect">
                  <img src="images/service-img6.jpg" class="img-fluid " alt="image" style="width:350px; height:316px; object-fit: cover">
                </div>
              </a>
              <a href="services-single.html" class="hover-color">
                <h4 class="text-white mt-3 mb-2">Kids' Haircuts</h4>
              </a>
            </div>
          </div>
        </div>
  
        <div class="text-center">
          <a class="btn btn-light mt-5" href="services.html">See All Services</a>
        </div>
  
      </div>
      </div>
    </section>
  
    <section id="about-us">
      <div class="container-lg padding-medium ">
        <div class="row flex-row-reverse align-items-center justify-content-between">
          <div class="col-md-6">
            <div class="video my-5">
              <div class="video-content position-relative open-up" style="width: 550px; height: 550px;">
                <!-- Background Image -->
                <div class="video-bg">
                  <img src="images/about-img.jpg" alt="video" class="video-image img-fluid w-100 h-100" style="object-fit: cover;">
                </div>
          
                <!-- Video Player -->
                <div class="video-player position-absolute top-0 start-0 w-100 h-100">
                  <video id="myVideo" class="w-100 h-100" preload="metadata" style="display: none; object-fit: cover;">
                    <source src="/vid/video-bg.mp4" type="video/mp4">
                  </video>
          
                  <!-- Play Button -->
                  <div class="play-button-overlay position-absolute" onclick="playVideo()">
                    <iconify-icon icon="ion:play-sharp" class="video-icon p-4"></iconify-icon>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
  
          <div class="col-md-5 mt-5 mt-md-0">
            <div class="section-title">
              <h2 class="display-4 fw-normal mb-3 text-capitalize">Most Trusted, Clean, and Recommended Barber Shop</h2>
            </div>
            <p>Experience the perfect blend of style, precision, and relaxation at our barber shop. Our expert barbers are
              dedicated to providing top-quality haircuts, beard trims, and grooming services that leave you looking and
              feeling your best.</p>
            <ul>
              <li>Skilled barbers offering the latest styles and trends.</li>
              <li>Premium grooming products for the best results.</li>
              <li>Relaxing ambiance with top-notch customer service.</li>
            </ul>
            <a class="btn btn-primary mt-3" href="about.html">About Us</a>
          </div>
  
        </div>
      </div>
    </section>

  
    <section id="price" class="jarallax"
      style="background-image: url(images/background-11.jpg); background-size: cover; background-repeat: no-repeat; background-position: center;">
      <div class="container-lg padding-medium">
        <div class="section-title text-center mb-5">
          <h2 class="display-4 fw-normal text-white">Price Packages</h2>
        </div>
  
        <div class="container py-5">
          <div class="d-flex flex-column align-items-center">
        
        
            <!-- Pricing Cards -->
            <div class="row  flex-column flex-md-row">
              <!-- Starter Plan -->
              <div class="col-12 col-md-6 mb-3 mb-md-0">
                <div class="card h-100 border-light shadow-sm">
                  <div class="card-body p-4">
                    <h2 class="card-title fs-4 fw-bold text-dark">Home Service</h2>
                    <p class="card-text text-muted">Convenient, clean, and stylish — our home service brings the salon experience to your living room.</p>
                    <div class="mt-4">
                      <span class="fs-1 fw-bold text-dark" id="home-service">₦20000</span>
                      <span class="text-muted">/mo</span>
                    </div>
                    <button onclick="payWithPaystackSubscribe2()" class="btn btn-dark w-100 mt-4 fw-semibold">Subscribe</button>
                  </div>
                  <div class="card-footer p-4 border-top">
                    <h3 class="text-uppercase fw-bold text-dark small">What's included</h3>
                    <ul class="list-unstyled mt-3">
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Haircut at your home or location of choice</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Professional stylist visit</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Haircut, trim, or styling of your choice</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Beard grooming (optional)</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>All tools and cleanup included</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Flexible scheduling at your convenience</span>
                      </li>
                    </ul>
                  </div>
                  
                </div>
              </div>
        
              <!-- Superior Plan -->
        
              <!-- Shipper Plan -->
              <div class="col-12 col-md-6 mb-3 mb-md-0 ">
                <div class="card h-100 border-light shadow-sm">
                  <div class="card-body p-4">
                    <h2 class="card-title fs-4 fw-bold text-dark">Office Service</h2>
                    <p class="card-text text-muted">Visit our salon for a professional haircut in a clean, relaxing environment.</p>
                    <div class="mt-4">
                      <span class="fs-1 fw-bold text-dark">₦15000</span>
                      <span class="text-muted">/mo</span>
                    </div>
                    <button onclick="payWithPaystackSubscribe()" class="btn btn-dark w-100 mt-4 fw-semibold">Subscribe</button>
                  </div>
                  <div class="card-footer p-4 border-top">
                    <h3 class="text-uppercase fw-bold text-dark small">What's included</h3>
                    <ul class="list-unstyled mt-3">
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Professional haircut at our salon</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Hair wash and scalp massage</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Beard trim or edge-up (optional)</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Personalized style consultation</span>
                      </li>
                      <li class="d-flex align-items-center mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 me-2 text-success" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                          <path d="M5 12l5 5l10 -10"></path>
                        </svg>
                        <span>Complimentary refreshments</span>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
  
      </div>
      </div>

 
</div>

    </section>
  
    <section id="gallery">
      <div class="container-lg padding-medium ">
        <h2 class="display-4 fw-normal text-center mb-5">View gallery</h2>
        <div class="row entry-container">
  
          <div class="entry-item col-md-4 my-3">
            <a href="images/post-3.jpg" title="photo" class="image-link"><img src="images/post-3.jpg"
                class=" post-image img-fluid" ></a>
          </div>
          <div class="entry-item col-md-4 my-3">
            <a href="images/post-6.jpg" title="photo" class="image-link"><img src="images/post-6.jpg"
                class=" post-image img-fluid"></a>
          </div>
          <div class="entry-item col-md-4 my-3">
            <a href="images/post-2.jpg" title="photo" class="image-link"><img src="images/post-2.jpg"
                class=" post-image img-fluid"></a>
          </div>
          <div class="entry-item col-md-4 my-3">
            <a href="images/post-4.jpg" title="photo" class="image-link"><img src="images/post-4.jpg"
                class=" post-image img-fluid"></a>
          </div>
          <div class="entry-item col-md-4 my-3">
            <a href="images/post-5.jpg" title="photo" class="image-link"><img src="images/post-5.jpg"
                class=" post-image img-fluid"></a>
          </div>
  
          <div class="entry-item col-md-4 my-3">
            <a href="images/post-1.jpg" title="photo" class="image-link"><img src="images/post-1.jpg"
                class=" post-image img-fluid"></a>
          </div>
  
        </div>
        <div class="text-center">
          <a class="btn btn-primary mt-5" href="gallery.html">View Gallery</a>
        </div>
      </div>
    </section>
  
    <section id="testimonial" class="jarallax" style="background-image: url('images/testimonial-bg.jpg');">   
      <div class="container-lg padding-medium">
  
        <div class="offset-md-2 col-md-8">
          <div class="swiper testimonial-swiper py-3 py-md-5 bg-white shadow-sm">
            <div class="swiper-wrapper">
              <div class="swiper-slide">
                <div class="review px-md-5">
                  <div class="review-content px-5 d-lg-flex align-items-center ">
                    <img src="images/team1.jpg" alt="reviewer" class="img-fluid rounded-circle" style="width:200px; height:200px">
                    <div class="ms-md-4 mt-3 mt-lg-0">
                      <p>“TeezCut completely changed the way I feel about grooming. The atmosphere is welcoming, the team is skilled, and the results speak for themselves. From the moment I walked in, I knew I was in good hands. Highly recommended!”</p>
                      <h2 class="name m-0 lh-sm">William Hayes</h3>
                    </div>
                  </div>
                </div>
              </div>
              <div class="swiper-slide">
                <div class="review px-md-5">
                  <div class="review-content px-5 d-lg-flex align-items-center ">
                    <img src="images/team2.jpg" alt="reviewer" class="img-fluid rounded-circle" style="width:200px; height:200px;">
                    <div class="ms-md-4 mt-3 mt-lg-0">
                      <p>“I’ve tried a lot of barbershops, but TeezCut stands out. They actually listen to what you want and deliver it perfectly. It’s more than just a haircut — it’s a full experience.”</p>
                      <h2 class="name m-0 lh-sm">James Adams</h3>
                    </div>
                  </div>
                </div>
              </div>
              <div class="swiper-slide">
                <div class="review px-md-5">
                  <div class="review-content px-5 d-lg-flex align-items-center ">
                    <img src="images/team3.jpg" alt="reviewer" class="img-fluid rounded-circle" style="width:200px; height:200px;">
                    <div class="ms-md-4 mt-3 mt-lg-0">
                      <p>“Every visit to TeezCut feels like a reset. The cuts are clean, the products are top quality, and the team knows how to keep you looking fresh. I wouldn’t go anywhere else.”</p>
                      <h2 class="name m-0 lh-sm">Oliver Bennett</h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="swiper-pagination position-relative pt-4 pt-md-5"></div>
          </div>
        </div>
  
      </div>
      </div>
    </section>
  

  
    <section id="appointment" class="jarallax"
      style="background-image: url(images/background-22.jpg); background-repeat: no-repeat; background-position: center;">
  
      <div class="container-lg padding-medium">
  
        <div class="offset-md-3 col-md-6 text-center ">
  
          <h2 class="display-4 fw-normal text-white mb-3">Make An Appointment</h2>
          <p class=" text-white">Call: 666 333 9999 or Fill in the form below</p>
  
  
          <form class="contact-form row mt-5" id="bookingForm">
            <div class="form-input col-lg-12 mb-3">
              <input type="text" name="address" placeholder="Enter Address"
                class="form-control w-100 rounded-0 border-0 ps-4 py-3 mb-2 me-3" required>
            </div>
            <div class="form-input col-lg-12 mb-3">
              <input type="date" name="date"
                class="form-control w-100 rounded-0 border-0 ps-4 py-3 mb-2 me-3" required>
            </div>
            <div class="form-input col-lg-12 mb-3">
              <input type="time" name="time"
                class="form-control w-100 rounded-0 border-0 ps-4 py-3 mb-2" required>
            </div>
            <div class="d-flex justify-content-center">
              <button type="button" class="btn btn-light mt-3 px-4" onclick="payWithPaystack()">Book Now</button>
            </div>
          </form>
  
        </div>
  
      </div>
      </div>
    </section>

    <script src="https://js.paystack.co/v2/inline.js"> </script>

    <script>
     async function getUser() {
      const getTokenFromCookie = () => {
  const match = document.cookie.match(/(?:^|;\s*)token=([^;]+)/);
  return match ? match[1] : null;
};

const data = {
  token: getTokenFromCookie()
};


      try {
        const response = await fetch('/token', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        console.log('Token response:', result);
        return result
      } catch (error) {
        console.error('Error fetching token:', error);
      }
     }   
    
     function isLoggedIn() {
   
        return document.cookie.includes('token');
      }
  
     async function payWithPaystack() {
        const form = document.getElementById('bookingForm');
        const address = form.address.value;
        const date = form.date.value;
        const time = form.time.value;
  
        if (!address || !date || !time) {
          alert("Please fill in all fields.");
          return;
        }
  
        if (!isLoggedIn()) {
          // Save booking data and redirect to login
          localStorage.setItem('pendingBooking', JSON.stringify({ address, date, time }));
          window.location.href = '/login?resume=1';
          return;
        }
        const user = await getUser();
        
        // If logged in, continue with payment
        const handler = PaystackPop.setup({
          key: 'pk_test_9fdf369bc0d71598bacbc34a4215690521c80938', // Replace with your public key
          email:user.data.email, // Replace with actual user email
          amount: 500000, // ₦5000 in kobo
          currency: 'NGN',
          ref: '' + Math.floor(Math.random() * 1000000000 + 1),
          metadata: {
            custom_fields: [
              { display_name: "Address", variable_name: "address", value: address },
              { display_name: "Date", variable_name: "date", value: date },
              { display_name: "Time", variable_name: "time", value: time }
            ]
          },
          callback: async function(response) {
          //  alert('Payment successful! Reference: ' + response.reference);
            localStorage.removeItem('pendingBooking');
            const getTokenFromCookie = () => {
  const match = document.cookie.match(/(?:^|;\s*)token=([^;]+)/);
  return match ? match[1] : null;
};

const data2 = {
  token: getTokenFromCookie()
};
const data = {
   address: document.querySelector('[name="address"]').value,
   time: document.querySelector('[name="time"]').value,
   date: document.querySelector('[name="date"]').value,
   reference: response.reference

}
            try {
        const response = await fetch('/booking', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            "Authorization":`Bearer ${data2.token}`
          },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        console.log('Token response:', result);
      } catch (error) {
        console.error('Error fetching token:', error);
      }
          },
          onClose: function() {
            alert('Transaction was not completed.');
          }
        });
  
        handler.openIframe();
      }
  
      // Auto-resume payment after login
      window.addEventListener('DOMContentLoaded', () => {
        console.log('✅ DOMContentLoaded triggered');
        const resume = new URLSearchParams(window.location.search).get('resume');
        const pending = localStorage.getItem('pendingBooking');
        console.log(pending)
        console.log(resume)
        if (resume && pending && isLoggedIn()) {
          const data = JSON.parse(pending);
          document.querySelector('[name="address"]').value = data.address;
          document.querySelector('[name="date"]').value = data.date;
          document.querySelector('[name="time"]').value = data.time;
          payWithPaystack();
        }
      });



async function payWithPaystackSubscribe() {

   
  if (!isLoggedIn()) {
          // Save booking data and redirect to login
          localStorage.setItem('pendingOfficeSub', true);
          window.location.href = '/login?resume=1';
          return;
        }
        const user = await getUser();

  const handler = PaystackPop.setup({
  key: 'pk_test_9fdf369bc0d71598bacbc34a4215690521c80938',
  email: user.data.email,
  amount: 0, 
  plan: 'PLN_a9yr5l7v8siagt1',
channels: ['card'], 
callback: function(response) {
alert('Payment successful! Reference: ' + response.reference);
},
onClose: function() {
alert('Transaction was not completed.');
}
});
handler.openIframe();
}


async function payWithPaystackSubscribe2() {
     
  if (!isLoggedIn()) {
          // Save booking data and redirect to login
          localStorage.setItem('pendingHomeSub', true);
          window.location.href = '/login?resume=1';
          return;
        }
        const user = await getUser();

const handler = PaystackPop.setup({
key: 'pk_test_9fdf369bc0d71598bacbc34a4215690521c80938',
email: user.data.email,
amount: 0, 
plan: 'PLN_sszple1j0oce5t3',
channels: ['card'], 
callback: function(response) {
alert('Payment successful! Reference: ' + response.reference);
},
onClose: function() {
alert('Transaction was not completed.');
}
});
handler.openIframe();

}


    </script>
<script>
    function playVideo() {
      console.log(true)
    const video = document.getElementById('myVideo');
    const overlay = document.querySelector('.play-button-overlay');

    overlay.style.display = 'none'; // hide the play icon
    video.style.display = 'block';  // show the video
    video.play();                   // start playback
  }
  
</script>    <%- include('partials/footer') %>



